# 3.2 TODO 작성과 사양 책정

## TODO 작성: 개발의 출발점

### TODO의 중요성

AITDD에서 적절한 TODO 작성은 성공의 열쇠입니다. 모호한 TODO는 이후의 모든 단계에 악영향을 미치므로, 명확하고 실행 가능한 TODO를 작성하는 것이 중요합니다.

### 효과적인 TODO 작성 원칙

#### 1. 구체성 확보
```markdown
❌ 나쁜 예: "사용자 관리 기능을 만든다"
✅ 좋은 예: "사용자 신규 등록 기능을 구현한다 (email/password 인증)"
```

#### 2. 적절한 단위
- **너무 큼**: 하나의 TODO에 여러 기능이 포함됨
- **너무 작음**: 개별 메서드 단위
- **적절함**: 하나의 완결된 기능 단위

#### 3. 완료 조건의 명확화
```markdown
## TODO: 사용자 등록 API 구현

### 완료 조건
- [ ] POST /api/users 엔드포인트 구현
- [ ] email/password 검증
- [ ] 패스워드 해시화
- [ ] 데이터베이스 저장
- [ ] 응답 형식 통일
```

### TODO 관리 파일 구조

#### 기본 포맷

```markdown
# 프로젝트 TODO 관리

## 구현 예정
### 높은 우선순위
- [ ] **사용자 인증 기능**
  - 설명: JWT 인증을 통한 인증 기능
  - 완료 조건: 로그인/로그아웃/토큰 검증
  - 의존성: 데이터베이스 설계 완료

### 중간 우선순위
- [ ] **상품 검색 기능**
  - 설명: 키워드와 카테고리를 통한 상품 검색
  - 완료 조건: 검색 API + 필터링 기능

## 진행 중
- [x] 데이터베이스 설계 (2024-06-21 완료)

## 완료
- [x] 프로젝트 초기 설정 (2024-06-20 완료)
```

#### 파일 구성 권장사항

```
doc/
├── todo.md                    # 메인 TODO 관리
├── implementation/
│   ├── user-auth-requirements.md      # 개별 기능의 상세 사양
│   ├── user-auth-testcases.md         # 테스트 케이스
│   └── search-requirements.md
└── archive/
    └── completed-todos.md              # 완료된 TODO 아카이브
```

## 사양 책정: 설계의 기반

### 사양 책정의 목적

TODO에서 구체적인 기술 사양을 책정하고, 구현의 방향성을 명확히 합니다. 이 단계에서의 모호함은 이후 단계에서 큰 문제가 되므로, 세부 사항까지 검토하는 것이 중요합니다.

### 사양서 템플릿

```markdown
# [기능명] 요구사항 정의서

## 개요
기능의 목적과 개요를 간결하게 설명

## 기능 요구사항

### 기본 기능
- 필수가 되는 기본적인 기능

### 상세 사양
- 입력 항목과 검증
- 처리 흐름
- 출력 형식

### 비기능 요구사항
- 성능 요구사항
- 보안 요구사항
- 가용성 요구사항

## 기술 사양

### API 사양
- 엔드포인트
- 요청/응답 형식
- 상태 코드

### 데이터베이스 설계
- 테이블 설계
- 인덱스
- 제약조건

### 오류 처리
- 오류 케이스 정의
- 오류 메시지
- 로그 출력 방침

## 제약사항
- 기술적 제약
- 비즈니스 제약
- 외부 의존성

## 참고 자료
- 관련 문서
- 외부 API 사양서
```

### 구체적인 사양 책정 예시

#### 예시: 사용자 등록 기능 사양

```markdown
# 사용자 등록 기능 요구사항 정의서

## 개요
새로운 사용자가 email과 password로 등록할 수 있는 기능

## 기능 요구사항

### 기본 기능
- email/password를 통한 신규 사용자 등록
- 중복 email 검증
- 패스워드 강도 체크

### 상세 사양

#### 입력 항목
- **email**: 필수, email 형식, 최대 254자
- **password**: 필수, 8자 이상, 영숫자 특수문자 포함
- **password_confirmation**: 필수, password와 일치

#### 검증
- email 중복 체크 (데이터베이스 확인)
- password 강도 (대문자/소문자/숫자/특수문자 포함)
- CSRF 토큰 검증

#### 처리 흐름
1. 입력값 검증
2. email 중복 체크
3. password 해시화 (bcrypt)
4. 데이터베이스 저장
5. 성공 응답 반환

### 비기능 요구사항
- 응답 시간: 2초 이내
- 동시 등록: 100건/초까지 대응
- 패스워드 해시화 필수

## 기술 사양

### API 사양
```
POST /api/users
Content-Type: application/json

Request:
{
  "email": "user@example.com",
  "password": "SecurePass123!",
  "password_confirmation": "SecurePass123!"
}

Response (201):
{
  "id": 123,
  "email": "user@example.com",
  "created_at": "2024-06-21T10:00:00Z"
}

Response (400):
{
  "error": "validation_failed",
  "details": [
    {
      "field": "email",
      "message": "Email already exists"
    }
  ]
}
```

### 데이터베이스 설계
```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  email VARCHAR(254) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_users_email ON users(email);
```

### 오류 처리
- **400**: 검증 오류, 중복 email
- **429**: 속도 제한
- **500**: 서버 오류

## 제약사항
- 패스워드는 평문 저장 금지
- email 확인 기능은 이번에는 포함하지 않음
- 소셜 로그인은 이번에는 포함하지 않음
```

## 사람 검토 포인트

### 체크 항목

#### 1. 완전성 확인
- [ ] 필요한 기능이 모두 포함되어 있는가
- [ ] 엣지 케이스가 고려되었는가
- [ ] 오류 처리가 충분한가

#### 2. 실현 가능성 검증
- [ ] 기술적으로 구현 가능한가
- [ ] 성능 요구사항이 현실적인가
- [ ] 보안 요구사항이 적절한가

#### 3. 일관성 확인
- [ ] 다른 기능과의 정합성
- [ ] 데이터 설계의 일관성
- [ ] API 인터페이스의 통일성

#### 4. 유지보수성 고려
- [ ] 향후 확장성
- [ ] 테스트의 용이성
- [ ] 문서화의 용이성

### 검토 시 주의사항

#### AI 제안을 활용할 때의 주의점
- AI의 제안은 참고로 활용
- 최종 판단은 반드시 사람이 수행
- 프로젝트 고유의 요구사항은 사람이 추가

#### 단계적 상세화
```
1. 개요 수준의 사양 → 검토
2. 상세 사양 추가 → 검토
3. 기술 사양 책정 → 검토
4. 최종 확인 → 승인
```

## 사양 책정 베스트 프랙티스

### 1. 명확하고 모호하지 않은 표현
```markdown
❌ "적절히 처리한다"
✅ "오류 시 400 상태 코드와 오류 메시지를 반환한다"
```

### 2. 구체적인 수치 명시
```markdown
❌ "빠르게 처리한다"
✅ "2초 이내에 응답을 반환한다"
```

### 3. 제약사항 명확화
```markdown
❌ "보안에 주의한다"
✅ "패스워드는 bcrypt로 해시화하고, 평문 저장은 금지"
```

### 4. 테스트 가능성 고려
- 각 사양 항목이 테스트 가능한지 확인
- 테스트 데이터 준비 방법 고려
- Mock이나 Stub의 필요성 검토

## 다음 단계로의 준비

사양 책정이 완료되면, 다음은 [테스트 케이스 작성](./03-test-case-creation.md)으로 진행합니다.

### 성과물 확인
- [ ] TODO.md가 적절히 업데이트되어 있음
- [ ] requirements.md가 상세히 작성되어 있음
- [ ] 사양에 모호한 부분이 남아있지 않음
- [ ] 사람에 의한 검토가 완료됨

### 자주 발생하는 문제와 대책

#### 사양이 모호한 채로 진행됨
**대책**: 반드시 사람 검토를 실시하고, 의문점은 즉시 해결

#### AI 제안에 과도하게 의존함
**대책**: AI의 제안은 참고 수준으로 활용하고, 최종 판단은 사람이 수행

#### 비기능 요구사항이 누락됨
**대책**: 체크리스트를 사용하여 체계적으로 검토

적절한 사양 책정으로 이후의 테스트 케이스 작성과 구현이 원활하게 진행됩니다.