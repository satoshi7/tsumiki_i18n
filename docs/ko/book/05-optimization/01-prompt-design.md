# 5.1 효과적인 프롬프트 설계의 원칙

## 들어가며

AITDD에서 AI의 출력 품질은 프롬프트 설계에 크게 의존합니다. 적절한 프롬프트 설계로 AI 생성 코드의 품질 향상과 개발 효율의 극대화를 실현할 수 있습니다. 이 장에서는 실천적인 프롬프트 설계의 원칙과 구체적인 기법을 배웁니다.

## 프롬프트 설계의 기본 원칙

### 1. 반복 개선 방식 채택

AITDD에서는 한 번의 프롬프트 작성으로 완벽한 결과를 기대하는 것이 아니라, 지속적인 개선을 전제로 설계합니다.

**기본 사이클:**
```
프롬프트 작성 → 실행 → 결과 평가 → 수정 → 재실행
```

**실천 포인트:**
- 첫 시도에서는 80%의 품질을 목표로 하고, 완벽을 추구하지 않음
- 각 실행 결과를 상세히 분석하여 개선점 특정
- 작은 수정을 쌓아서 최적화 달성
- 개선 로그를 기록하고 패턴 파악

### 2. 확신도 평가 도입

AI가 자신의 출력에 대한 확신도를 평가하게 함으로써 검토해야 할 부분을 효율적으로 특정할 수 있습니다.

**확신도 지표:**
- **🟢 높은 확신도**: 참조 파일에서 명확히 도출 가능
- **🟡 중간 확신도**: 합리적 추측에 기반하나 확인 필요
- **🔴 판단 필요**: 독자 판단에 의한 생성으로 중점 확인 필요

### 3. 단계별 커스터마이징

TDD의 각 단계(Red, Green, Refactor, Validation)별로 프롬프트를 최적화합니다.

**단계별 특징:**
- **Red**: 테스트 작성의 명확성과 포괄성 중시
- **Green**: 최소 구현과 의도하지 않은 변경 방지
- **Refactor**: 품질 향상과 기능 유지의 균형
- **Validation**: 종합적 품질 체크와 과제 발견

## AITDD에서의 프롬프트 패턴

### 패턴1: TODO 기록 지시

AI 생성 결과의 확인해야 할 항목을 TODO 형식으로 기록하게 하는 패턴입니다.

**기본 템플릿:**
```markdown
## 프롬프트에서의 지시 예시

다음 처리를 실행하고, 결과를 TODO 리스트로 기록해주세요:

**실행 내용:**
[구체적인 지시 내용]

**TODO 기록 형식:**
```markdown
## [단계명]결과 TODO

### 🟢 높은 확신도 항목
- [ ] [파일명](상대 경로)의 구체적 확인 내용

### 🟡 중간 확신도 항목  
- [ ] [파일명](상대 경로)의 추정 내용의 타당성 확인

### 🔴 판단 필요 항목
- [ ] 상세 확인: [파일명](상대 경로)의 조직 고유 내용
```

**참조 파일:** [지정할 파일 리스트]
**출력 파일:** `./todos/[단계명]-check.md`
```

### 패턴2: 확신도 평가 지시

AI 생성 내용의 근거와 확신도를 명시하게 하는 패턴입니다.

**기본 템플릿:**
```markdown
## 확신도 평가 지시

각 생성 내용에 대해 다음 기준으로 확신도를 평가해주세요:

**평가 기준:**
- 🟢 초록불: 참조 파일에서 명확히 추측 가능
- 🟡 노란불: 합리적 추측이나 확인 필요
- 🔴 빨간불: 독자 판단에 의한 생성

**평가 대상:**
1. 생성한 코드의 각 기능
2. 테스트 케이스 선택 이유
3. 구현 방침 결정 근거

**출력 형식:**
- 각 항목에 신호등 마크 부여
- 근거가 되는 참조 파일 위치 명기
- 추측 이유를 간결히 설명
```

### 패턴3: 단계적 상세화 지시

복잡한 구현을 단계적으로 진행하기 위한 패턴입니다.

**기본 템플릿:**
```markdown
## 단계적 구현 지시

다음 순서로 단계적으로 구현을 진행해주세요:

**Phase 1: 기본 구조**
- 최소한의 동작 확인
- 주요 함수/클래스의 골격
- 기본적인 테스트 케이스

**Phase 2: 기능 확장**
- 구체적인 기능 구현
- 에러 핸들링
- 추가 테스트 케이스

**Phase 3: 최적화**
- 성능 개선
- 코드 품질 향상
- 종합 테스트

**각 단계 후 확인:**
- 테스트 실행 결과 보고
- 확신도 평가 실시
- 다음 단계로의 과제 정리
```

## 실천적인 프롬프트 구성 요소

### 필수 요소 체크리스트

프롬프트 작성 시 반드시 포함해야 할 요소:

- [ ] **명확한 목적 정의**
  - 무엇을 실현하고 싶은지 명확한 설명
  - 기대하는 출력의 구체적 형식

- [ ] **참조 파일 지정**
  - 근거로 삼을 파일 명기
  - 파일 간 관계성 설명

- [ ] **확신도 평가 지시**
  - 신호등 시스템 적용 지시
  - 평가 기준의 명확한 정의

- [ ] **출력 형식 지정**
  - 파일명과 저장 위치 지정
  - 마크다운 형식 등의 상세 지정

- [ ] **제약과 주의사항 명기**
  - 변경하면 안 되는 부분
  - 특별한 고려사항

### 템플릿화 가능한 부분

**표준 헤더 예시:**
```markdown
## [단계명] 실행 지시

**목적:** [구체적인 목적]
**참조 파일:** [파일 리스트]
**출력 파일:** [저장 경로]

**확신도 평가:**
각 생성 내용에 대해 🟢🟡🔴로 확신도 표시

**제약사항:**
- [중요한 제약사항]
```

### 커스터마이징이 필요한 부분

프로젝트별로 커스터마이징해야 할 요소:

1. **도메인 고유의 용어·개념**
   - 업계 특유 용어의 정의
   - 프로젝트 내 명명 규칙

2. **기술 스택 고유의 제약**
   - 사용 프레임워크의 제약
   - 성능 요구사항

3. **조직 고유의 규칙**
   - 코딩 규약
   - 보안 가이드라인

## 품질 확보를 위한 프롬프트 기법

### 1. 예상 외 구현 방지

**대책 기법:**
```markdown
## 구현 제약의 명확화

**변경 허용 범위:**
- 변경 가능: [구체적인 파일·함수명]
- 변경 금지: [기존의 동작하는 부분]

**구현 방침:**
- 최소한의 변경으로 목적 달성
- 기존 기능에 대한 영향 최소화
- 신규 추가를 기본으로 하고 기존 수정은 최소한

**확인 체크:**
- [ ] 지정 범위 외의 변경이 포함되지 않았는가
- [ ] 기존 테스트가 계속 성공하는가
- [ ] 의도하지 않은 부작용이 발생하지 않았는가
```

### 2. 참조원 파일과의 관계성 명시

**관계성 명시 예시:**
```markdown
## 참조 파일 관계도

**주요 참조:**
- `spec.md` → 요구사항 정의의 근거
- `existing_test.js` → 기존 사양 확인
- `config.json` → 설정 사양 참조

**파생 참조:**
- `utils.js` → 기존 유틸리티 활용
- `types.ts` → 타입 정의의 정합성 확보

**생성 시 참조 우선순위:**
1. 주요 참조를 최우선
2. 모순되는 내용은 주요 참조 채택
3. 불명확한 점은 명확히 질문으로 기록
```

### 3. 단계적 상세화의 구현

**상세화 전략:**
```markdown
## 단계적 상세화 프로세스

**Level 1: 골격 작성**
- 인터페이스 정의
- 주요 함수 시그니처
- 기본적인 에러 핸들링

**Level 2: 기능 구현**
- 비즈니스 로직 구현
- 상세한 에러 핸들링
- 입력값 검증

**Level 3: 최적화·완성**
- 성능 최적화
- 엣지 케이스 대응
- 문서 정리

**각 레벨에서의 확인 항목:**
- 테스트 실행 결과
- 확신도 평가
- 다음 레벨로의 과제
```

## 실천 연습

### 연습1: 기본 프롬프트 작성

다음 시나리오에서 프롬프트를 작성해주세요:

**시나리오:** 사용자 인증 기능의 테스트 케이스 작성
**참조 파일:** `auth_spec.md`, `user_model.js`
**기대하는 출력:** Jest 형식의 테스트 파일

**작성해야 할 요소:**
1. 명확한 목적 정의
2. 참조 파일 지정
3. 확신도 평가 지시
4. 출력 형식 지정

### 연습2: 단계적 구현 프롬프트 설계

**시나리오:** REST API 엔드포인트 구현
**요구사항:** 복잡한 데이터 처리 포함
**제약:** 기존 미들웨어 활용

**설계해야 할 요소:**
1. 3단계 구현 단계
2. 각 단계의 성과물
3. 단계 간 확인 항목

## 정리

효과적인 프롬프트 설계의 핵심은 다음과 같습니다:

1. **반복 개선**: 한 번에 완벽을 추구하지 않고 지속적인 개선을 전제
2. **확신도 평가**: AI의 추측 부분을 가시화하여 효율적인 검토 실현
3. **단계별 최적화**: TDD의 각 단계에 맞는 프롬프트 설계
4. **품질 제어**: 예상 외 구현 방지와 참조원 명확화

다음 섹션에서는 이러한 원칙을 구체적으로 활용하는 AI 추론의 가시화 기술에 대해 자세히 학습합니다.