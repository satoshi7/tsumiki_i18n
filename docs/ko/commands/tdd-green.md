# TDD Green 단계（구현）

TDD의 Green 단계를 실행합니다.

## 사전 준비

개발 컨텍스트의 준비를 진행합니다：

**Task 도구 실행**: `/tdd-load-context`로 TDD 관련 파일 읽기와 컨텍스트 준비 실행

읽기 완료 후, 준비된 컨텍스트 정보를 바탕으로 Green 단계（구현）의 작업을 시작합니다.

**테스트 실행 시 Task 도구를 이용**

## 신뢰성 수준 지시

구현 코드 작성 시에는, 각 구현 내용에 대해 원본 자료와의 대조 상황을 다음 신호로 코멘트해 주세요：

- 🟢 **청신호**: 원본 자료를 참고하여 거의 추측하지 않은 경우
- 🟡 **황신호**: 원본 자료에서 타당한 추측을 한 경우
- 🔴 **적신호**: 원본 자료에 없는 추측을 한 경우

## 목표

Red 단계에서 생성한 테스트를 통과시키기 위한 **구현**을 수행해 주세요.

## 구현 원칙

- **테스트가 확실히 통과하는 것이 최우선**
- 코드의 아름다움은 부차적（다음 Refactor 단계에서 개선）
- "일단 동작하는" 수준으로 OK
- 복잡한 로직은 나중으로, 단순한 구현을 지향
- 테스트가 잘 통과하지 않을 때는 Task 도구를 사용하여 실패 원인을 조사 후 수정 계획을 세워 구현
- 기존 테스트가 에러가 된 경우 사양을 바탕으로 적절히 수정
- **Mock 사용 제한**: 테스트 코드 이외에서 Mock을 기술하지 않음（구현 코드는 실제 로직을 작성）
- **파일 크기 관리**: 구현 파일이 800행을 초과한 시점에서 파일 분할 검토
- NEVER: 필요한 테스트의 건너뛰기 금지
- NEVER: 필요한 테스트의 삭제 금지
- NEVER: 구현 코드 내에서 Mock・Stub의 기술 금지
- NEVER: 구현 코드 내에서 DB 대신 인메모리 스토리지 이용 금지
- NEVER: 구현 코드 내에서 DB 조작의 생략 금지

## 구현 시 일본어 코멘트 요건

구현 코드에는 다음 일본어 코멘트를 반드시 포함해 주세요：

### 함수・메소드 레벨의 코멘트

```javascript
/**
 * 【機能概要】: [이 함수가 무엇을 하는지 일본어로 설명]
 * 【実装方針】: [왜 이런 구현 방법을 선택했는지 설명]
 * 【テスト対応】: [어떤 테스트 케이스를 통과시키기 위한 구현인지 명기]
 * 🟢🟡🔴 신뢰성 레벨: [이 구현이 원본 자료의 어느 정도에 기반하고 있는지]
 * @param {type} paramName - [파라미터 설명]
 * @returns {type} - [반환값 설명]
 */
function {{function_name}}(paramName) {
  // 【実装内容】: [구현하고 있는 처리의 상세 설명]
}
```

### 처리 블록 레벨의 코멘트

```javascript
function processData(input) {
  // 【入力値検証】: [입력값의 타당성을 체크하는 이유와 방법] 🟢🟡🔴
  if (!input) {
    throw new Error('입력값이 부정확합니다'); // 【エラー処理】: [왜 이 에러가 필요한지 설명] 🟢🟡🔴
  }

  // 【データ処理開始】: [메인 처리의 시작을 명시] 🟢🟡🔴
  // 【処理方針】: [이 처리가 테스트를 통과하기 위해 어떻게 기여하는지 설명] 🟢🟡🔴
  const result = {
    // 【結果構造】: [반환값의 구조와 그 이유를 설명]
    validData: [],
    invalidData: [],
    errors: [],
  };

  // 【結果返却】: [처리 결과를 반환하는 이유와 내용 설명]
  return result;
}
```

### 변수・상수의 코멘트

```javascript
// 【定数定義】: [이 상수가 필요한 이유와 사용 목적]
const MAX_FILE_SIZE = 1024 * 1024; // 【制限値】: 파일 크기 상한（1MB）설정

// 【変数初期化】: [이 변수가 테스트 통과를 위해 왜 필요한지 설명]
let processedCount = 0; // 【カウンタ】: 처리 완료 파일 수를 추적하기 위한 카운터
```

### 에러 핸들링의 코멘트

```javascript
try {
  // 【実処理実行】: [실제 처리를 실행하는 부분 설명]
  const data = processFile(filePath);
} catch (error) {
  // 【エラー捕捉】: [에러가 발생한 경우의 대처 방침]
  // 【テスト要件対応】: [테스트에서 기대되는 에러 핸들링을 충족하기 위한 처리]
  return {
    success: false,
    error: error.message, // 【エラー情報】: 테스트에서 검증되는 에러 메시지를 적절히 반환
  };
}
```

## 구현 예시

```javascript
/**
 * 【機能概要】: JSON 파일 경로를 검증하고, 유효/무효한 경로를 분류한다
 * 【実装方針】: 테스트 케이스를 통과시키기 위해 최소한 필요한 기능만 구현
 * 【テスト対応】: tdd-red 단계에서 생성된 테스트 케이스를 통과시키기 위한 구현
 */
function {{function_name}}(input) {
  // 【入力値検証】: 부정한 입력값을 조기에 검출하여 에러를 방지
  if (!input) {
    // 【エラー処理】: 테스트에서 기대되는 에러 케이스에 대응
    throw new Error('입력값이 필요합니다');
  }

  // 【最小限実装】: 테스트를 통과하기 위한 가장 단순한 구현
  // 【ハードコーディング許可】: 리팩터 단계에서 개선 예정이므로, 현 단계에서는 고정값으로 OK
  return {{simple_return_value}};
}
```

## 단계적 구현 가이드라인

1. **먼저 하나의 테스트 케이스만 통과시키기**
   - 【実装戦略】: 여러 테스트의 동시 대응은 복잡화를 초래하므로 피함
   - 【品質確保】: 하나씩 확실히 구현함으로써 품질 담보
2. **가장 간단한 방법으로 구현**
   - 【シンプル実装】: 복잡한 알고리즘은 후의 리팩터에서 추가
   - 【可読性重視】: 현 단계에서는 이해하기 쉬움을 최우선
3. **파일 크기를 의식한 구현**
   - 【800行制限】: 구현 파일이 800행을 초과한 시점에서 분할 검토
   - 【モジュール設計】: 기능 단위로 파일을 적절히 분리
   - 【関数分割】: 긴 함수는 작은 단위로 분할하여 구현
   - 【責任境界】: 각 파일의 책임 범위를 명확히 하여 구현
   - 【分割戦略】: 기능・레이어・도메인으로 파일 분리
4. **코드 품질 기준 고려**
   - 【静的解析対応】: lint나 typecheck에서 에러가 나지 않는 구현을 지향
   - 【フォーマット統一】: 프로젝트의 기존 포맷에 맞춘 구현
   - 【命名規則遵守】: 프로젝트의 명명 규칙에 따른 구현
5. **다른 테스트 케이스는 나중에**
   - 【段階的開発】: TDD 원칙에 따라, 한 스텝씩 진행
   - 【影響範囲限定】: 변경의 영향을 최소한으로 억제
6. **에러 핸들링도 최소한**
   - 【必要最小限】: 테스트에서 요구되는 부분만 구현
   - 【将来拡張可能】: 리팩터 단계에서 상세한 에러 처리 추가 예정
7. **Mock 사용 제한**
   - 【実装コード制限】: 구현 코드 내에서 Mock・Stub 사용하지 않음
   - 【テストコード限定】: Mock은 테스트 코드 내에서만 사용
   - 【実際のロジック実装】: 구현 코드는 실제 처리를 기술
   - 【依存関係注入】: 필요에 따라 의존성 주입 패턴으로 구현

## 제공해 주세요

1. **구현 코드**: 테스트를 통과하는 코드（필수 일본어 코멘트 포함）
2. **테스트 실행 결과**: Task 도구를 사용하여 실제로 테스트가 통과함을 확인
3. **구현 설명**: 어떤 생각으로 구현했는지（일본어 코멘트와의 대응 관계）
4. **과제 특정**: 현재 구현의 문제점（리팩터 대상의 명확화）
5. **파일 크기 체크**: 구현 파일의 행 수 확인（800행 초과 시 분할 계획）
6. **Mock 사용 확인**: 구현 코드에 Mock・Stub이 포함되지 않았음을 확인

구현 완료 후, 다음을 실행해 주세요：

1. **메모 파일 업데이트**: docs/implements/{{task_id}}/{feature_name}-memo.md 파일의 Green 단계 섹션을 업데이트
   - 구현 방침, 구현 코드, 테스트 결과, 과제・개선점을 기록
   - 다음 Refactor 단계에서 참조할 수 있도록 상세히 기록
2. 구현 코드와 설계 내용을 docs/implements/{{task_id}}/{feature_name}-green-phase.md에 저장（기존 파일이 있는 경우 추기）
3. TODO 상태를 업데이트（Green 단계 완료를 마크）
4. **자동 전환 판정**: 다음 조건을 만족하는 경우 자동으로 `/tdd-refactor` 실행
   - Task 도구를 사용하여 모든 테스트가 성공함을 확인 완료
   - 구현이 단순하고 이해하기 쉬움
   - 명백한 리팩터링 부분이 있음
   - 기능적 문제가 없음
5. **수동 확인**: 자동 전환 조건을 만족하지 않는 경우 다음을 제공해 주세요：
   - "Task 도구를 사용하여 테스트가 통과했음을 확인했습니다."
   - "현재 구현: [간결한 설명]"
   - "구현에 포함한 일본어 코멘트: [코멘트의 목적과 내용]"
   - "리팩터링 후보: [개선해야 할 점]"
   - "다음 Refactor 단계로 진행해도 괜찮습니까？"

## 품질 판정 기준

```
✅ 고품질:
- 테스트 결과: Task 도구에 의한 실행으로 모두 성공
- 구현 품질: 단순하고 동작함
- 리팩터 부분: 명확히 특정 가능
- 기능적 문제: 없음
- 컴파일 에러: 없음
- 파일 크기: 800행 이하 또는 분할 계획이 명확
- Mock 사용: 구현 코드에 Mock・Stub이 포함되지 않음

⚠️ 요개선:
- 테스트의 일부 실패（Task 도구로 검출）
- 구현이 너무 복잡
- 리팩터 방침이 불명
- 기능에 우려가 있음
- 컴파일 에러가 존재
- 파일 크기가 800행 초과하고 분할 계획이 불명
- 구현 코드에 Mock・Stub이 포함됨
```

## TODO 업데이트 패턴

```
- 현재 TODO「Green 단계（최소 구현）」를「completed」로 마크
- 최소 구현 단계의 완료를 TODO 내용에 반영
- 품질 판정 결과를 TODO 내용에 기록
- 다음 단계「Refactor 단계（품질 개선）」를 TODO에 추가
```

다음 스텝: `/tdd-refactor`로 코드 품질을 개선합니다.